\begin{minipage}{0.55\textwidth}
  \refstepcounter{minipagecount}
  \noindent{(\theminipagecount)}\quad
  \begin{tikzpicture}[scale=1.0, baseline=(current bounding box.north)]
    \begin{scope}[rotate=<<rotation>>]
        % Draw square
        \draw (0,0) coordinate (<<vA>>) --
              ++(<<sidelength1>>,0) coordinate (<<vB>>) --
              ++(0,<<sidelength2>>) coordinate (<<vC>>) --
              ++(-<<sidelength1>>,0) coordinate (<<vD>>) -- cycle;

        % Right angle markers
        \foreach \p/\q/\r in {<<vD>>/<<vA>>/<<vB>>,<<vA>>/<<vB>>/<<vC>>,<<vB>>/<<vC>>/<<vD>>,<<vC>>/<<vD>>/<<vA>>} {
            \pic [draw, -, angle radius=0.2cm] {right angle=\p--\q--\r};
        }

        % Vertex LABELS
        % Labels relative to shape geometry
        % \ifTrue  or \ifFalse
        <<show_vertices>>
            \node at ($(<<vA>>)+(-0.2,-0.2)$) {<<vA>>};
            \node at ($(<<vB>>)+(0.2,-0.2)$) {<<vB>>};
            \node at ($(<<vC>>)+(0.2,0.2)$) {<<vC>>};
            \node at ($(<<vD>>)+(-0.2,0.2)$) {<<vD>>};
        \fi

        % double Tick marks across horizontal side <<vA>>--<<vB>>
        \draw[thin, gray]
            ($(<<vA>>)!0.5!(<<vB>>) + (-0.03,-0.10)$) --
            ($(<<vA>>)!0.5!(<<vB>>) + (-0.03,0.10)$);

        \draw[thin, gray]
            ($(<<vA>>)!0.5!(<<vB>>) + (0.03,-0.10)$) --
            ($(<<vA>>)!0.5!(<<vB>>) + (0.03,0.10)$);

        % double Tick marks across horizontal side <<vD>>--<<vC>>
        \draw[thin, gray]
            ($(<<vD>>)!0.5!(<<vC>>) + (-0.03,-0.10)$) --
            ($(<<vD>>)!0.5!(<<vC>>) + (-0.03,0.10)$);

        \draw[thin, gray]
            ($(<<vD>>)!0.5!(<<vC>>) + (0.03,-0.10)$) --
            ($(<<vD>>)!0.5!(<<vC>>) + (0.03,0.10)$);


        % Tick marks across vertical sides
        \draw[thin, gray]
            ($(<<vB>>)!0.5!(<<vC>>) + (-0.10,0)$) --
            ($(<<vB>>)!0.5!(<<vC>>) + (0.10,0)$);

        \draw[thin, gray]
            ($(<<vA>>)!0.5!(<<vD>>) + (-0.10,0)$) --
            ($(<<vA>>)!0.5!(<<vD>>) + (0.10,0)$);


        % Horizontal side (A-B), shifted down; draw=none; <->, gray
        \draw[<<draw_style>>]
            ($(<<vA>>) + (0,-0.50cm)$) -- ($(<<vB>>) + (0,-0.50cm)$)
            node[black, midway, fill=white, inner sep=2pt] {<<calc_sidelength1>><<units>>};

        % Vertical side (B-C), shifted right
        \draw[<<draw_style>>]
            ($(<<vB>>) + (0.50cm,0)$) -- ($(<<vC>>) + (0.50cm,0)$)
            node[black, midway, fill=white, xshift=2mm, inner sep=2pt] {<<calc_sidelength2>><<units>>};


    \end{scope}
\end{tikzpicture}
\end{minipage}%
\hfill
\begin{minipage}{.4\textwidth}
  \begin{align*}
  \text{Perimeter} &= 2 \times (\,\text{l + w}) \\
  \text{Perimeter} &= <<calc_formula_part1>> \times (<<calcside_value1>> \,\text{<<calc_units>>} + <<calcside_value2>> \,\text{<<calc_units>>}) \\
  \text{Perimeter} &= <<calc_perimeter_value>> \,\text{<<calc_units>>}
  \end{align*}
\end{minipage}

