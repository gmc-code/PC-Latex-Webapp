\documentclass{article}
\usepackage{tikz}
\usepackage{geometry}
\pagestyle{empty}
\usepackage{xstring}

% === Paper and Margin Variables ===
% === Apply geometry using variables ===
\geometry{
  paperwidth=<<paperwidth>> cm,
  paperheight=<<paperheight>> cm,
  vmargin=<<vmargin>> cm,
  hmargin=<<hmargin>> cm,
}

% ===Helper to draw one dot at x, y ===
\newcommand{\drawdot}[2]{%
  \IfStrEq{<<dotfilltype>>}{open}{%
    % Case: open circle
    \draw[draw=<<dotcolor>>, fill=none, line width=<<dotlinewidth>>] (#1,#2) circle (<<dotsize>>);
  }{%
    % filled circle
      \fill[<<dotcolor>>] (#1,#2) circle (<<dotsize>>);
  }%
}


\begin{document}
\begin{tikzpicture}[remember picture, overlay]
  % Anchor to bottom-left of the physical page
  \begin{scope}[shift={(current page.south west)}]
    % Work in centimeters and shift to content area
    \begin{scope}[x=1cm, y=1cm, shift={(<<hmargin>>,<<vmargin>>)}]

      % Usable area
      \pgfmathsetmacro{\usablewidth}{<<paperwidth>> - 2*<<hmargin>>}
      \pgfmathsetmacro{\usableheight}{<<paperheight>> - 2*<<vmargin>>}

      % Convert pt to cm for padding
      \pgfmathsetmacro{\pad}{(<<dotsize>> + 0.5*<<dotlinewidth>>)/28.45274}

      % Clip to content area (+ tiny pad)
      \clip (-\pad,-\pad) rectangle (\usablewidth+\pad, \usableheight+\pad);

      % Hex grid spacing based on orientation
      \IfStrEq{<<gridorientation>>}{vertical}{
        \pgfmathsetmacro{\dx}{<<dotspacing>>}
        \pgfmathsetmacro{\dy}{<<dotspacing>> * sqrt(3)}
        \pgfmathsetmacro{\offsetx}{\dx/2}
        \pgfmathsetmacro{\offsety}{\dy/2}
      }{
        \pgfmathsetmacro{\dy}{<<dotspacing>>}
        \pgfmathsetmacro{\dx}{<<dotspacing>> * sqrt(3)}
        \pgfmathsetmacro{\offsety}{\dy/2}
        \pgfmathsetmacro{\offsetx}{\dx/2}
      }

      % Integer loop bounds
      \pgfmathtruncatemacro{\xcount}{ceil((\usablewidth+\pad)/\dx)+1}
      \pgfmathtruncatemacro{\ycount}{ceil((\usableheight+\pad)/\dy)+1}

      % Draw dots
      \foreach \i in {0,...,\xcount} {
        \foreach \j in {0,...,\ycount} {
          \pgfmathsetmacro{\x}{\i * \dx}
          \pgfmathsetmacro{\y}{\j * \dy}
          \drawdot{\x}{\y}
          \drawdot{\x+\offsetx}{\y+\offsety}
        }
      }

    \end{scope}
  \end{scope}
\end{tikzpicture}
\end{document}
