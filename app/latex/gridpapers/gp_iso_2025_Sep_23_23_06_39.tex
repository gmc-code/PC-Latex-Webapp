\documentclass{article}
\usepackage{tikz}
\usepackage{geometry}
\pagestyle{empty}
\usepackage{xstring}

% === Paper and Margin Variables ===
% === Apply geometry using variables ===
\geometry{
  paperwidth=21 cm,
  paperheight=29.7 cm,
  vmargin=1.5 cm,
  hmargin=1.5 cm,
}


% Helper to draw one dot
% \newcommand{\drawdot}[2]{%
%   \IfStrEq{filled}{open}{%
%     \draw[draw=black, fill=none, line width=0.4pt] (#1,#2) circle (0.8pt);
%   }{%
%     \ifxfill\fill
%       \fill[black] (#1,#2) circle (0.8pt);
%     \else\ifxfill\draw
%       \draw[black, line width=0.4pt] (#1,#2) circle (0.8pt);
%     \else
%       \filldraw[fill=black, draw=black, line width=0.4pt] (#1,#2) circle (0.8pt);
%     \fi\fi
%   }%
% }
% === Helper to draw one dot ===
\newcommand{\drawdot}[2]{%
  \IfStrEq{filled}{open}{%
    % Case: open circle
    \draw[draw=black, fill=none, line width=0.4pt] (#1,#2) circle (0.8pt);
  }{%
    \IfStrEq{fill}{fill}{%
      \fill[black] (#1,#2) circle (0.8pt);
    }{%
      \IfStrEq{fill}{draw}{%
        \draw[black, line width=0.4pt] (#1,#2) circle (0.8pt);
      }{%
        \filldraw[fill=black, draw=black, line width=0.4pt] (#1,#2) circle (0.8pt);
      }%
    }%
  }%
}




\begin{document}
\begin{tikzpicture}[remember picture, overlay]
  % Anchor to bottom-left of the physical page
  \begin{scope}[shift={(current page.south west)}]
    % Work in centimeters and shift to content area
    \begin{scope}[x=1cm, y=1cm, shift={(1.5,1.5)}]

      % Usable area
      \pgfmathsetmacro{\usablewidth}{21 - 2*1.5}
      \pgfmathsetmacro{\usableheight}{29.7 - 2*1.5}

      % Convert pt to cm for padding
      \pgfmathsetmacro{\pad}{(0.8pt + 0.5*0.4pt)/28.45274}

      % Clip to content area (+ tiny pad)
      \clip (-\pad,-\pad) rectangle (\usablewidth+\pad, \usableheight+\pad);

      % Hex grid spacing based on orientation
      \IfStrEq{vertical}{vertical}{
        \pgfmathsetmacro{\dx}{0.8}
        \pgfmathsetmacro{\dy}{0.8 * sqrt(3)}
        \pgfmathsetmacro{\offsetx}{\dx/2}
        \pgfmathsetmacro{\offsety}{\dy/2}
      }{
        \pgfmathsetmacro{\dy}{0.8}
        \pgfmathsetmacro{\dx}{0.8 * sqrt(3)}
        \pgfmathsetmacro{\offsety}{\dy/2}
        \pgfmathsetmacro{\offsetx}{\dx/2}
      }

      % Integer loop bounds
      \pgfmathtruncatemacro{\xcount}{ceil((\usablewidth+\pad)/\dx)+1}
      \pgfmathtruncatemacro{\ycount}{ceil((\usableheight+\pad)/\dy)+1}

      % Draw dots
      \foreach \i in {0,...,\xcount} {
        \foreach \j in {0,...,\ycount} {
          \pgfmathsetmacro{\x}{\i * \dx}
          \pgfmathsetmacro{\y}{\j * \dy}
          \drawdot{\x}{\y}
          \drawdot{\x+\offsetx}{\y+\offsety}
        }
      }

    \end{scope}
  \end{scope}
\end{tikzpicture}
\end{document}
